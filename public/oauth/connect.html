<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Vincall manage system" />
    <title>Vin Call</title>
  </head>
  <body>
    <div>Connecting ...</div>
    <div id="error-msg"></div>
    <script src="./util.js"></script>
    <script>
      var search = getSearch(),
        success = search.success,
        errMsg = search.errMsg;
      localStorage.setItem("connect_accessToken", search.access_token);

      if (window.opener && window.opener.__refreshComm100Connect) {
        window.opener.__refreshComm100Connect(!errMsg);
      }
      if (errMsg) {
        document.getElementById("error-msg").innerText = errMsg;
        setTimeout(() => {
          window.close();
        }, 10000);
      } else {
        setTimeout(() => {
          window.close();
        }, 3000);
      }
    </script>
  </body>
</html>
